{
    "queries": [
        [
            {
                "$group": {
                "_id": "$content",
                "count": {
                    "$sum": 1
                }
                }
            },
            {
                "$sort": {
                "count": -1
                }
            },
            {
                "$limit": 5
            }
            ],
    
      [
        {
          "$match": {
            "$expr": {
              "$lt": [
                {
                  "$strLenCP": "$content"
                },
                5
              ]
            }
          }
        }
      ],
      [
        {
          "$group": {
            "_id": {
              "$dateToString": {
                "format": "%Y-%m-%d",
                "date": {
                  "$toDate": "$at"
                }
              }
            },
            "averageScore": {
              "$avg": "$score"
            }
          }
        },
        {
          "$project": {
            "date": {
              "$toDate": "$_id"
            },
            "averageScore": "$averageScore",
            "_id": 0
          }
        }
      ]
    ]
}
  
  